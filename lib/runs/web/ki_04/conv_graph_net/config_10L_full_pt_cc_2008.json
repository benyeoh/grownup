[
    { 
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "model": {
	        "ktf.models.Sequential": {
	            "name": "tower",
	            "layers": [
	                {
                        "ktf.models.networks.RecurrentCGN": {
                            "name": "gcn",
                            "layers": [
                                2,
                                2,
                                2,
                                2,
                                2,
                                2,
                                2,
                                2,
                                2,
                                2
                            ],
                            "debug_self_loops": null,
                            "num_prelim_blocks": [768, 256],
                            "hidden_base_feature_size": 256,
                            "output_feature_size": 512,
                            "use_residuals": true,
                            "aggregator": "gat_gated",
                            "normalization": "layer",
                            "recurrent_cell": "lstm",
                            "aggregator_activation": "relu",
                            "recurrent_activation": "tanh",
                            "dropout": 0.4
                        }
                    },
	                {
                        "ktf.models.components.GraphReadoutSum": {
                            "use_mean": true
                        }
                    },
                    {
                        "ktf.models.components.DenseL2Norm": {
                            "units": 8,
                            "use_bias": false
                        }
                    }
	            ]
	        }
        },
       
        "loss": [
            {

                "ktf.models.losses.LinearArcLoss": {
                    "scale": 40.0,
                    "arcloss_margin": 0.4
                }
            }
        ],
        
        "metrics": [
            [
                {
                    "tf.keras.metrics.SparseCategoricalAccuracy": {}
                }
            ]     
        ],
     
        "optimizer": {
            "ktf.train.optimizers.diff_lr_wrap": {
                "optimizer_class": "${tfa.optimizers.AdamW}",
                "learning_rate": 0.002,
                "weight_decay": 0.0001, 
                "debug_info": false,
                "lr_list": [
                    ["base_model/gcn/lstm_cell/.*", 0.5],
                    ["base_model/gcn/prelim_block0/.*", 0.15],
                    ["base_model/gcn/prelim_block1/.*", 0.2],
                    ["base_model/gcn/layer0_block.*", 0.3],
                    ["base_model/gcn/layer1_block.*", 0.4],
                    ["base_model/gcn/layer2_block.*", 0.5],
                    ["base_model/gcn/layer3_block.*", 0.55],
                    ["base_model/gcn/layer4_block.*", 0.6],
                    ["base_model/gcn/layer5_block.*", 0.65],
                    ["base_model/gcn/layer6_block.*", 0.7],
                    ["base_model/gcn/layer7_block.*", 0.75],
                    ["base_model/gcn/layer8_block.*", 0.8],
                    ["base_model/gcn/layer9_block.*", 0.85],
                    ["base_model/.*", 1.0]
                ]
            }
        },
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ktf/weights/custom/gcn/commoncrawl/2008_2009/10l_256h_all.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_0.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    },
    
    // 1
    {
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ben/ktf/runs/web/commoncrawl/gcn_unsuper_pair_10xl3.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_1.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    },
    
    // 2
    {
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ben/ktf/runs/web/commoncrawl/gcn_unsuper_pair_10xl3.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_2.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    },
    
    // 3
    {
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ben/ktf/runs/web/commoncrawl/gcn_unsuper_pair_10xl3.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_3.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    },
    
    // 4
    {
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ben/ktf/runs/web/commoncrawl/gcn_unsuper_pair_10xl3.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_4.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    },
    
    // 5
    {
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ben/ktf/runs/web/commoncrawl/gcn_unsuper_pair_10xl3.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_5.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    },
    
    // 6
    {
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ben/ktf/runs/web/commoncrawl/gcn_unsuper_pair_10xl3.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_6.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    },
    
    // 7
    {
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ben/ktf/runs/web/commoncrawl/gcn_unsuper_pair_10xl3.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_7.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    },
    
    // 8
    {
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ben/ktf/runs/web/commoncrawl/gcn_unsuper_pair_10xl3.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_8.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    },
    
    // 9
    {
        "datasets": {        
            "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                "tfrecord_dir": ["/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split0/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split1/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split2/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split3/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split4/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split5/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split6/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split7/**",
                                 "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split8/**"],
                "config_path": "/hpc-datasets/web/ki_04/tfrecord/config.json",
                "batch_size": 32,
                "validation_split": 0.0,
                "shuffle_size": 1200,
                "repeat": false
            }
        },
        
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 35,
                "num_steps": null,
                "num_valid_steps": null,
                "pretrained_weights": [
                    [
                        "gcn",
                        "/hpc-datasets/ben/ktf/runs/web/commoncrawl/gcn_unsuper_pair_10xl3.h5"
                    ]
                ],
                
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 5,
                                    "t_mul": 2,
                                    "alpha": 0.05
                                }
                            },
                            
                            "verbose": true
                        }
                        
                    },

                    {
                        "ktf.train.callbacks.Evaluate": {
                            "dataset": {
                                "ktf.datasets.web.ki_04.from_tfrecord_graph": {
                                    "tfrecord_dir": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/split9/**",
                                    "config_path": "/hpc-datasets/web/ki_04/tfrecord_10fold_5555/config_no_eig.json",
                                    "batch_size": 32,
                                    "validation_split": 0.0,
                                    "shuffle_size": null,
                                    "repeat": false
                                }   
                            },
                            "monitor": "${list(range(15, 35))}",
                            "mode": "max"
                        }
                    },
                    
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ada/runs/ktf/web/ki_04/arc_gcn_unsuper_pair_10xl3/10cv_arc_5555/ki04_9.h5",
                            "save_best_only": false,
                            "save_weights_only": true,
                            "verbose": 1
                        }
                    }
                ],
                
                "save_dir": null
            }
        }
    }
]
