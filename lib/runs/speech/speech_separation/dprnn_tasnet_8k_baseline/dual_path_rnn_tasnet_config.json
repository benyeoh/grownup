[
    {
        "datasets": {
            "ktf.datasets.process_chain": {
                "input": {
                    "ktf.datasets.join": {
                        "dataset_tuples": [
                            {
                                "ktf.datasets.speech.wsj0_mix.from_tfrecord": {
                                    "wsj0_mix_tfrecord_dir": "/home/klass/klassterfork/data/wsj0-mix/2speakers/wav8k/min_clean/wsj0-mix-tfrecord/tr",
                                    "validation_split": 0,
                                    "shuffle_size": 20000,
                                    "batch_size": 2
                                }
                            },
                            {
                                "ktf.datasets.speech.wsj0_mix.from_tfrecord": {
                                    "wsj0_mix_tfrecord_dir": "/home/klass/klassterfork/data/wsj0-mix/2speakers/wav8k/min_clean/wsj0-mix-tfrecord/cv",
                                    "validation_split": 0,
                                    "shuffle_size": 5000,
                                    "batch_size": 2
                                }
                            }
                        ]
                    }
                }
            }
        },
        "model": {
            "ktf.models.networks.TasnetWithDprnn": {
                "num_filters": 64,
                "filter_size": 2,
                "num_chunks": 125,
                "chunk_size": 256,
                "units_per_lstm": 200,
                "num_dprnn_blocks": 3,
                "num_speakers": 2
            }
        },
        "loss": {
            "ktf.models.losses.PITLoss2spk": {}
        },
        "metrics": [
            {
                "ktf.models.metrics.ScaleInvariantSNR2Speakers": {}
            }
        ],
        "optimizer": {
            "tf.keras.optimizers.Adam": {
                "learning_rate": 0.001
            }
        },
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 200,
                "save_dir": null,
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "ktf.train.callbacks.StepDecayScheduler": {}
                            }
                        }
                    },
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/tmp/ktf/dual_path_rnn_tasnet/checkpoint/weights.epoch{epoch:02d}-val_loss{val_loss:.2f}.h5",
                            "save_weights_only": true
                        }
                    },
                    {
                        "tf.keras.callbacks.EarlyStopping": {
                            "patience": 10
                        }
                    }
                ]
            }
        }
    }
]