[
    {
        "datasets": {
            "ktf.datasets.process_chain": {
                "input": {
                    "ktf.datasets.join": {
                        "dataset_tuples": [
                            {
                                "ktf.datasets.cars.stanford_cars.from_tfrecord": {
                                    "stanford_car_tfrecord_dir": "/hpc-datasets/cars/stanford_car/original_kaggle/tfrecord_600_resize_without_pad/train",
                                    "validation_split": 0,
                                    "shuffle_size": 8144,
                                    "batch_size": 16
                                }
                            },
                            {
                                "ktf.datasets.cars.stanford_cars.from_tfrecord": {
                                    "stanford_car_tfrecord_dir": "/hpc-datasets/cars/stanford_car/original_kaggle/tfrecord_600_resize_without_pad/test",
                                    "validation_split": 0,
                                    "batch_size": 512
                                }
                            }
                        ]
                    }
                },
                "0": [
                    {
                        "ktf.datasets.process.ImgAugmentation": {
                            "horizontal_flip_prob": 1,
                            "random_crop_prob": 1,
                            "random_crop_size": [
                                448,
                                448,
                                3
                            ],
                            "central_crop_prob": 0,
                            "standardize_prob": 0
                        }
                    }
                ],
                "1": [
                    {
                        "ktf.datasets.process.ImgAugmentation": {
                            "horizontal_flip_prob": 0,
                            "random_crop_prob": 0,
                            "central_crop_prob": 1,
                            "central_crop_old_size": 600.0,
                            "central_crop_new_size": 448.0,
                            "standardize_prob": 0
                        }
                    }
                ],
                ":": [
                    {
                        "ktf.datasets.process.ImgAugmentation": {
                            "horizontal_flip_prob": 0,
                            "random_crop_prob": 0,
                            "central_crop_prob": 0,
                            "standardize_prob": 1,
                            "standardize_mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "standardize_std_dev": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    }
                ]
            }
        },
        "model": {
            "ktf.models.OneHeadNet": {
                "base_model": {
                    "tf.keras.applications.ResNet50V2": {
                        "include_top": false,
                        "input_shape": [
                            448,
                            448,
                            3
                        ],
                        "pooling": "avg",
                        "weights": null
                    }
                },
                "num_outputs": 196,
                "regularizer": {
                    "tf.keras.regularizers.L1L2": {
                        "l1": 0.0,
                        "l2": 0.0005
                    }
                }
            }
        },
        "loss": {
            "tf.keras.losses.SparseCategoricalCrossentropy": {
                "from_logits": true
            }
        },
        "metrics": [
            {
                "tf.keras.metrics.SparseCategoricalAccuracy": {}
            }
        ],
        "optimizer": {
            "tf.keras.optimizers.SGD": {
                "learning_rate": 0.005,
                "momentum": 0.9
            }
        },
        "train_loop": {
            "ktf.train.KerasTrainLoop": {
                "num_epochs": 300,
                "pretrained_weights": [
                    [
                        "resnet50v2",
                        "/hpc-datasets/ktf/weights/keras_apps/resnet50v2/resnet50v2_weights_tf_dim_ordering_tf_kernels_notop.h5"
                    ]
                ],
                "save_dir": "/hpc-datasets/ben/ktf/runs/stanford_cars/baseline/",
                "callbacks": [
                    {
                        "tf.keras.callbacks.LearningRateScheduler": {
                            "schedule": {
                                "tf.keras.experimental.CosineDecayRestarts": {
                                    "initial_learning_rate": 0.005,
                                    "first_decay_steps": 10,
                                    "t_mul": 2
                                }
                            }
                        }
                    },
                    {
                        "tf.keras.callbacks.ModelCheckpoint": {
                            "filepath": "/hpc-datasets/ben/ktf/runs/stanford_cars/baseline/ckpt/best_val_acc_weight.h5",
                            "monitor": "val_sparse_categorical_accuracy",
                            "save_best_only": true,
                            "verbose": 1
                        }
                    }
                ]
            }
        }
    }
]